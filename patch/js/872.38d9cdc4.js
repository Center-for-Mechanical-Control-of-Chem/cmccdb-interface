"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[872],{6466:function(e,a,t){t.d(a,{A:function(){return d}});var s=t(6768),i=t(5130);const n={class:"spinner-main"};function l(e,a,t,l,r,o){return(0,s.uX)(),(0,s.CE)("div",n,[(0,s.bF)(i.eB,{name:"fade"},{default:(0,s.k6)((()=>a[0]||(a[0]=[(0,s.Lk)("div",{class:"loader-ring"},[(0,s.Lk)("div"),(0,s.Lk)("div"),(0,s.Lk)("div"),(0,s.Lk)("div")],-1)]))),_:1})])}var r={name:"LoadingSpinner",data(){return{}}},o=t(1241);const u=(0,o.A)(r,[["render",l],["__scopeId","data-v-da99072c"]]);var d=u},872:function(e,a,t){t.r(a),t.d(a,{default:function(){return oe}});var s=t(6768),i=t(5130),n=t(4232);const l={class:"main-contribute"},r={key:0,class:"loading"},o={key:0,class:"contribute-menu"},u={class:"title"},d={class:"contribute-container"},c={class:"tabs"},m=["onClick"],p={key:0,class:"get-started"},h={class:"copy"};function b(e,a,t,b,f,v){const g=(0,s.g2)("LoadingSpinner"),k=(0,s.g2)("All"),L=(0,s.g2)("Upload"),y=(0,s.g2)("Reconfigure");return(0,s.uX)(),(0,s.CE)("div",l,[(0,s.bF)(i.eB,{name:"fade"},{default:(0,s.k6)((()=>[f.loading?((0,s.uX)(),(0,s.CE)("div",r,[(0,s.bF)(g)])):(0,s.Q3)("",!0)])),_:1}),(0,s.bF)(i.eB,{name:"fade"},{default:(0,s.k6)((()=>[f.loading?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",o,[(0,s.Lk)("div",u,(0,n.v_)(f.activeTab),1),(0,s.Lk)("div",d,[(0,s.Lk)("div",c,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(f.tabs,(e=>((0,s.uX)(),(0,s.CE)("div",{class:(0,n.C4)(["tab",f.activeTab==e?"selected":""]),onClick:a=>f.activeTab=e},(0,n.v_)(e),11,m)))),256))]),(0,s.bF)(i.eB,{name:"fade"},{default:(0,s.k6)((()=>["Introduction"==f.activeTab?((0,s.uX)(),(0,s.CE)("div",p,[(0,s.Lk)("div",h,[a[1]||(a[1]=(0,s.eW)("We have adapted the ORD submission template to support a single-file workflow.")),(0,s.bF)(k,null,{default:(0,s.k6)((()=>a[0]||(a[0]=[(0,s.eW)("submissions are driven by a single spreadsheet file which is compiled down to a  ")]))),_:1}),a[2]||(a[2]=(0,s.Lk)("code",null,".pbtxt",-1)),a[3]||(a[3]=(0,s.eW)("  file with the  ")),a[4]||(a[4]=(0,s.Lk)("code",null,"construct_dataset.py",-1)),a[5]||(a[5]=(0,s.eW)("  script in the main repository."))])])):(0,s.Q3)("",!0)])),_:1}),(0,s.bF)(i.eB,{name:"fade"},{default:(0,s.k6)((()=>["Upload"==f.activeTab?((0,s.uX)(),(0,s.Wv)(L,{key:0})):(0,s.Q3)("",!0)])),_:1}),(0,s.bF)(i.eB,{name:"fade"},{default:(0,s.k6)((()=>["Reconfigure"==f.activeTab?((0,s.uX)(),(0,s.Wv)(y,{key:0})):(0,s.Q3)("",!0)])),_:1})])]))])),_:1})])}var f=t(6466);const v={class:"enumerate"},g={class:"file-picker"},k={class:"input"},L={class:"input"},y={class:"submit"};function C(e,a,t,i,n,l){return(0,s.uX)(),(0,s.CE)("div",v,[a[5]||(a[5]=(0,s.Lk)("div",{class:"subtitle"},"Upload files for enumeration:",-1)),(0,s.Lk)("div",g,[(0,s.Lk)("div",k,[a[3]||(a[3]=(0,s.Lk)("label",{for:"template"},"Template filename:",-1)),(0,s.Lk)("input",{id:"template",type:"file",accept:".pbtxt",onChange:a[0]||(a[0]=e=>l.setFile(e,"template"))},null,32)]),(0,s.Lk)("div",L,[a[4]||(a[4]=(0,s.Lk)("label",{for:"spreadsheet"},"Spreadsheet filename:",-1)),(0,s.Lk)("input",{id:"spreadsheet",type:"file",accept:".csv,.xls,.xlsx",onChange:a[1]||(a[1]=e=>l.setFile(e,"spreadsheet"))},null,32)])]),(0,s.Lk)("div",y,[(0,s.Lk)("button",{id:"enumerate_submit",onClick:a[2]||(a[2]=(...e)=>l.submitEnumerate&&l.submitEnumerate(...e))},"Submit Enumeration Upload")]),a[6]||(a[6]=(0,s.Fv)('<div class="copy" data-v-48ecb63a>You can use a Reaction template to enumerate a Dataset based on a spreadsheet of values. For more information, see the <a href="https://docs.open-reaction-database.org/en/latest/guides/templates.html" target="_blank" data-v-48ecb63a>documentation</a>.</div><div class="copy" data-v-48ecb63a><b data-v-48ecb63a>NOTE:</b> Large dataset enumerations (thousands of reactions) may result in a browser timeout. If this happens, please send an email to <a href="mailto:help@open-reaction-database.org" target="_blank" data-v-48ecb63a>help@open-reaction-database.org</a> and attach your template and spreadsheet files. Alternatively, you may use the <a href="https://github.com/Open-Reaction-Database/ord-schema/blob/main/ord_schema/scripts/enumerate_dataset.py" target="_blank" data-v-48ecb63a>programmatic interface</a> to enumerate the dataset locally.</div>',2))])}var F={data(){return{enumerateFiles:{template:{name:null,loading:!1,value:null},spreadsheet:{name:null,loading:!1,value:null}}}},methods:{async setFile(e,a){const t=e.target.files||e.dataTransfer.files;if(!t.length)return console.error("No file");this.enumerateFiles[a].loading=!0,this.enumerateFiles[a].name=t[0].name;const s=new FileReader;s.onload=e=>{this.enumerateFiles[a].value=e.target.result,this.enumerateFiles[a].loading=!1},"template"==a?s.readAsText(t[0]):"spreadsheet"==a&&s.readAsDataURL(t[0])},submitEnumerate(){if(this.enumerateFiles.template.loading||this.enumerateFiles.spreadsheet.loading)return alert("Files are still processing. Please try again in a moment.");if(!this.enumerateFiles.template.value||!this.enumerateFiles.spreadsheet.value)return alert("You must upload a file for the template and spreadsheet before submitting.");const e=new XMLHttpRequest;e.open("POST","/editor-api/dataset/enumerate"),e.onload=function(){200===e.status?location.reload():(alert(`Error: ${e.response}`),console.error(e.response))},e.send(JSON.stringify({template_string:this.enumerateFiles.template.value,spreadsheet_data:this.enumerateFiles.spreadsheet.value,spreadsheet_name:this.enumerateFiles.spreadsheet.name}))}}},w=t(1241);const _=(0,w.A)(F,[["render",C],["__scopeId","data-v-48ecb63a"]]);var E=_;const D={class:"upload"},U={class:"submit"},A={key:0,class:"info-panel"},S={class:"info-element"},T={id:"user-info-username"},I={class:"info-element"},R={class:"info-element"},X={key:0,class:"advanced-upload"},N={class:"file-picker"},x={class:"input"},P={key:1,class:"basic-upload"},O={class:"file-picker"},W={class:"input"},q={class:"submit"},B={class:"error-message"};function M(e,a,t,l,r,o){return(0,s.uX)(),(0,s.CE)("div",D,[a[15]||(a[15]=(0,s.Lk)("div",{class:"subtitle"},"Contributor Information:",-1)),(0,s.Lk)("div",U,[r.user.ghAuthenticated?((0,s.uX)(),(0,s.CE)("div",A,[(0,s.Lk)("div",S,[a[7]||(a[7]=(0,s.Lk)("label",{for:"user-info-username"},"GitHub ID:",-1)),(0,s.Lk)("code",T,(0,n.v_)(r.user.username),1)]),(0,s.Lk)("div",I,[a[8]||(a[8]=(0,s.Lk)("label",{for:"user-info-name"},"Name:",-1)),(0,s.bo)((0,s.Lk)("input",{id:"user-info-name",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>r.user.name=e)},null,512),[[i.Jo,r.user.name]])]),(0,s.Lk)("div",R,[a[9]||(a[9]=(0,s.Lk)("label",{for:"user-info-email"},"Email:",-1)),(0,s.bo)((0,s.Lk)("input",{id:"user-info-email",type:"text","onUpdate:modelValue":a[1]||(a[1]=e=>r.user.email=e)},null,512),[[i.Jo,r.user.email]])])])):((0,s.uX)(),(0,s.CE)("button",{key:1,id:"upload-submit",onClick:a[2]||(a[2]=(...e)=>o.ghAuthenticate&&o.ghAuthenticate(...e))},"Login with GitHub"))]),a[16]||(a[16]=(0,s.Lk)("div",{class:"subtitle"},"Upload dataset file:",-1)),r.advancedUpload?((0,s.uX)(),(0,s.CE)("div",X,[(0,s.Lk)("div",N,[(0,s.Lk)("div",x,[a[10]||(a[10]=(0,s.Lk)("label",{for:"upload"},"Dataset:",-1)),(0,s.Lk)("input",{id:"upload",type:"file",accept:".pbtxt,.pb",onChange:a[3]||(a[3]=e=>o.setFile(e))},null,32)])]),a[11]||(a[11]=(0,s.Lk)("div",{class:"copy"},[(0,s.eW)("Choose a  "),(0,s.Lk)("code",null,".pbtxt"),(0,s.eW)("  file compiled with the  "),(0,s.Lk)("code",null,"construct_dataset.py"),(0,s.eW)("  script in the  "),(0,s.Lk)("a",{href:"https://github.com/Center-for-Mechanical-Control-of-Chem/cmccdb-schema"},"cmccdb-schema repository")],-1))])):((0,s.uX)(),(0,s.CE)("div",P,[(0,s.Lk)("div",O,[(0,s.Lk)("div",W,[a[12]||(a[12]=(0,s.Lk)("label",{for:"upload"},"Dataset:",-1)),(0,s.Lk)("input",{id:"upload",type:"file",accept:".xlsx,.csv",onChange:a[4]||(a[4]=e=>o.setFile(e))},null,32)])]),a[13]||(a[13]=(0,s.Lk)("div",{class:"copy"},[(0,s.eW)("Choose a  "),(0,s.Lk)("code",null,".xlsx/.csv"),(0,s.eW)("  file following the CMCCDB template, examples are in the  "),(0,s.Lk)("a",{href:"https://github.com/Center-for-Mechanical-Control-of-Chem/cmccdb-data"},"cmccdb-data repository")],-1))])),(0,s.Lk)("div",q,[(0,s.Lk)("button",{id:"upload-submit",onClick:a[5]||(a[5]=(...e)=>o.submitUpload&&o.submitUpload(...e))},"Submit Upload"),(0,s.bo)((0,s.Lk)("input",{class:"advanced-toggle",id:"advanced-toggle",type:"checkbox","onUpdate:modelValue":a[6]||(a[6]=e=>r.advancedUpload=e)},null,512),[[i.lH,r.advancedUpload]]),a[14]||(a[14]=(0,s.Lk)("label",{for:"advanced-toggle"},"Use precompiled dataset",-1))]),(0,s.Lk)("div",B,[(0,s.Lk)("code",null,[(0,s.Lk)("pre",null,(0,n.v_)(r.traceback),1)])])])}t(4603),t(7566),t(8721);var H={data(){return{uploadFile:{name:null,loading:!1,value:null,file:null},user:{name:null,email:null,username:null,cmccMember:null,ghAuthenticated:!1},traceback:null,advancedUpload:!1}},mounted(){this.getUserData()},methods:{ghAuthenticate(){const e=new URLSearchParams("");e.set("origin_url",window.location),window.location.href="/api/authenticate?"+e.toString()},async getUserData(){this.user.ghAuthenticated||fetch("/api/user-info").then((e=>e.json().then((e=>{null!==e&&(this.user.ghAuthenticated=!0,this.user.name=e.name,this.user.email=e.email,this.user.cmccMember=e.member,this.user.username=e.username);const a=this.getSearchParams();null!==a.get("name")&&a.get("name").length&&(this.user.name=a.get("name")),null!==a.get("email")&&a.get("email").length&&(this.user.email=a.get("email"))}))))},getSearchParams(){const e=new URLSearchParams(window.location.search);return e},getDB(){const e=this.getSearchParams(),a=e.get("database"),t=a.length?a:"cmcc";return t},getQueryString(){const e=this.getSearchParams();return null!==this.user.name&&e.set("name",this.user.name),null!==this.user.username&&e.set("username",this.user.username),null!==this.user.email&&e.set("email",this.user.email),e.toString()},async setFile(e){const a=e.target.files||e.dataTransfer.files;if(!a.length)return console.error("No file");this.uploadFile.loading=!0,this.uploadFile.name=a[0].name,this.uploadFile.file=a[0],this.uploadFile.loading=!1},submitUpload(){if(!this.user.ghAuthenticated)return alert("Login with GitHub to upload.");if(!this.user.cmccMember&&"staging"!=this.getDB())return alert("Upload to primary database only supported for CMCC members.");if(this.uploadFile.loading)return alert("Files are still processing. Please try again in a moment.");if(!this.uploadFile.file)return alert("You must upload a file for the dataset before submitting.");const e=this.getQueryString(),a=new XMLHttpRequest,t=`/api/upload?${e}`;a.open("POST",t),console.log("POST:",this.uploadFile.name,t);let s=new FormData;s.append("uploadFile",this.uploadFile.file),a.onload=()=>{let e=JSON.parse(a.response);200===a.status?window.location.href="/search?limit=100&dataset_ids="+e["dataset_id"]:(this.traceback="ERROR: \n"+e["traceback"],alert("An error occured: see the traceback below"))},a.onerror=()=>{alert("Error: request failed (possibly due to timeout)")},a.send(s)}}};const G=(0,w.A)(H,[["render",M],["__scopeId","data-v-669bc511"]]);var Q=G;const $={class:"create"},J={class:"file-picker"},V={class:"input"},j={class:"submit"};function Y(e,a,t,n,l,r){return(0,s.uX)(),(0,s.CE)("div",$,[a[3]||(a[3]=(0,s.Lk)("div",{class:"subtitle"},"Create dataset:",-1)),(0,s.Lk)("div",J,[(0,s.Lk)("div",V,[a[2]||(a[2]=(0,s.Lk)("label",{for:"new-dataset-name"},"Dataset name:",-1)),(0,s.bo)((0,s.Lk)("input",{id:"new-dataset-name",type:"text","onUpdate:modelValue":a[0]||(a[0]=e=>l.newDatasetName=e)},null,512),[[i.Jo,l.newDatasetName]])])]),(0,s.Lk)("div",j,[(0,s.Lk)("button",{id:"create-dataset",onClick:a[1]||(a[1]=(...e)=>r.createDataset&&r.createDataset(...e))},"Create Dataset")]),a[4]||(a[4]=(0,s.Lk)("div",{class:"copy"},"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec tincidunt eros eget magna venenatis, nec volutpat justo ornare. Praesent mauris enim, dignissim nec posuere ut, mollis at lacus. Phasellus ut ultricies arcu, ultrices efficitur enim. Donec pharetra turpis nulla, id elementum felis fermentum sit amet. In id imperdiet sapien. Quisque vulputate odio eget ex aliquet aliquam. Vestibulum a metus magna.",-1))])}var K={data(){return{loading:!0,newDatasetName:null}},methods:{async getDatasets(){const e=await fetch("/editor-api/getDatasetsByUser/ef4a7184f6bf4d2da99d8e08b36882c0");console.log("res.json",e)},createDataset(){if(!this.newDatasetName)return alert("Enter a name for the new dataset.");const e=new XMLHttpRequest;e.datasetName=this.newDatasetName,e.open("POST",`/editor-api/dataset/${this.newDatasetName}/new`),e.onload=function(){409===e.status&&alert(`Error: Dataset "${this.datasetName}" already exists`)},e.send()}},mounted(){this.getDatasets()}};const z=(0,w.A)(K,[["render",Y],["__scopeId","data-v-4530c0b0"]]);var Z=z;const ee={class:"upload"},ae={class:"submit"};function te(e,a,t,i,n,l){return(0,s.uX)(),(0,s.CE)("div",ee,[a[1]||(a[1]=(0,s.Lk)("div",{class:"subtitle"},[(0,s.Lk)("div",{class:"copy"},"WARNING: RECONFIGURING THE DATABASE DELETES ALL EXISTING DATA")],-1)),(0,s.Lk)("div",ae,[(0,s.Lk)("button",{id:"upload-submit",onClick:a[0]||(a[0]=(...e)=>l.reconfigureDatabase&&l.reconfigureDatabase(...e))},"RECONFIGURE")])])}var se={data(){},methods:{reconfigureDatabase(){const e=new XMLHttpRequest;e.open("POST","/api/reconfigure"),e.onload=()=>{200===e.status?location.reload():alert("Error: "+e.response)},e.onerror=()=>{alert("Error: request failed (possibly due to timeout)")}}}};const ie=(0,w.A)(se,[["render",te],["__scopeId","data-v-1c342219"]]);var ne=ie,le={components:{LoadingSpinner:f.A,Enumerate:E,Upload:Q,Datasets:Z,Reconfigure:ne},data(){return{loading:!0,tabs:["Introduction","Upload"],activeTab:"Upload"}},computed:{},methods:{},async mounted(){const e=localStorage.getItem("notFirstTime");e||(localStorage.setItem("notFirstTime","false"),this.activeTab="Introduction"),this.$route.query.active_tab&&(this.activeTab=this.$route.query.active_tab),this.loading=!1}};const re=(0,w.A)(le,[["render",b],["__scopeId","data-v-59fe66ec"]]);var oe=re}}]);
//# sourceMappingURL=872.38d9cdc4.js.map